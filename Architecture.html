<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.5: http://docutils.sourceforge.net/" />
<title>DataONE Architecture</title>
<meta name="date" content="20090924" />
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 5196 2007-06-03 20:25:28Z wiemann $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left {
  clear: left }

img.align-right {
  clear: right }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font-family: serif ;
  font-size: 100% }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="dataone-architecture">
<h1 class="title">DataONE Architecture</h1>
<h2 class="subtitle" id="dataone-use-cases-and-apis">DataONE Use Cases and APIs</h2>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr><th class="docinfo-name">Date:</th>
<td>20090924</td></tr>
</tbody>
</table>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#use-cases-overview" id="id4">Use Cases Overview</a><ul>
<li><a class="reference internal" href="#use-case-layout" id="id5">Use Case Layout</a></li>
</ul>
</li>
<li><a class="reference internal" href="#use-case-implementation-priority" id="id6">Use Case Implementation Priority</a></li>
<li><a class="reference internal" href="#use-cases" id="id7">Use Cases</a><ul>
<li><a class="reference internal" href="#use-case-1-crud-read" id="id8">Use Case 1 - CRUD Read()</a><ul>
<li><a class="reference internal" href="#notes" id="id9">Notes</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#dataone-application-programming-interfaces" id="id10">DataONE Application Programming Interfaces</a><ul>
<li><a class="reference internal" href="#member-node-apis" id="id11">Member Node APIs</a><ul>
<li><a class="reference internal" href="#authorization-api" id="id12">Authorization API</a></li>
<li><a class="reference internal" href="#crud-api" id="id13">CRUD API</a></li>
<li><a class="reference internal" href="#replication-api" id="id14">Replication API</a></li>
<li><a class="reference internal" href="#server-authentication-api" id="id15">Server Authentication API</a></li>
<li><a class="reference internal" href="#capabilities-api" id="id16">Capabilities API</a></li>
</ul>
</li>
<li><a class="reference internal" href="#coordinating-node-apis" id="id17">Coordinating Node APIs</a><ul>
<li><a class="reference internal" href="#authentication-api" id="id18">Authentication API</a></li>
<li><a class="reference internal" href="#verify-api" id="id19">Verify API</a></li>
<li><a class="reference internal" href="#query-api" id="id20">Query API</a></li>
<li><a class="reference internal" href="#id1" id="id21">CRUD API</a></li>
<li><a class="reference internal" href="#id2" id="id22">Replication API</a></li>
<li><a class="reference internal" href="#synchronization-api" id="id23">Synchronization API</a></li>
<li><a class="reference internal" href="#register-api" id="id24">Register API</a></li>
<li><a class="reference internal" href="#id3" id="id25">Server Authentication API</a></li>
<li><a class="reference internal" href="#state-of-health-api" id="id26">State of Health API</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="use-cases-overview">
<h1><a class="toc-backref" href="#id4">Use Cases Overview</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Date:</th><td class="field-body">20090924</td>
</tr>
</tbody>
</table>
<p>An important early part in the process of system architecture is identifying
the functional requirements that the resulting system should be able to
address. Use cases are helpful for this as they describe how actors (typically
entities external to the system) interact with system components. Interaction
diagrams help define the interfaces and messages transmitted between
components.</p>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last">TODO: Architecture overview diagram</p>
</div>
<p>TODO: Component diagram</p>
<p>TODO: Broad categories of use cases</p>
<div class="section" id="use-case-layout">
<h2><a class="toc-backref" href="#id5">Use Case Layout</a></h2>
<p>Each use case document is structured following a common template which
includes the following elements.</p>
<dl class="docutils">
<dt>Author</dt>
<dd>Who generated the use case.  This will usually be &quot;VDC TWG&quot;.</dd>
<dt>Date</dt>
<dd>Date the use case was identified and known subsequent modifications.</dd>
<dt>Version</dt>
<dd>One of &quot;Draft&quot;, &quot;Review&quot;, &quot;Published&quot;</dd>
<dt>Goal</dt>
<dd>Brief description of what is intended with the use case.</dd>
<dt>Summary</dt>
<dd>An overview of the use case which includes the goal and major actors.</dd>
<dt>Use case diagram</dt>
<dd>A diagram representation of the use case, somewhat following the UML.</dd>
<dt>Sequence diagram</dt>
<dd>A sequence diagram that shows the operations involved in addressing the use
case.</dd>
<dt>Actors</dt>
<dd>The participants in the use case - includes people and systems.</dd>
<dt>Preconditions</dt>
<dd>The conditions that must exist for the use case. For example, a particular
use case may only be valid if the use has been authenticated.</dd>
<dt>Triggers</dt>
<dd>Describes the even that causes the use case to be initiated.</dd>
<dt>Postconditions</dt>
<dd>The state of the system after the use case - what conditions are true after
the use case is completed.</dd>
<dt>Notes</dt>
<dd>Miscellaneous notes and discussion items that can't be placed in the various
categories.  Comments should be annotated with time and author.</dd>
</dl>
</div>
</div>
<div class="section" id="use-case-implementation-priority">
<h1><a class="toc-backref" href="#id6">Use Case Implementation Priority</a></h1>
<p>Prioritizing system implementation to address the use cases involves several
factors including:</p>
<ul class="simple">
<li>Vision of the project. The system is being designed with some overall goals
described by the vision of the project proposal.</li>
<li>Requirements of the community. The stakeholders that comprise the user and
participant community quite likely has some opinion on functionalities of
the system that are important to them. If these are not properly addressed,
then the resulting system may appear as a failure to them.</li>
<li>Requirements of the sponsor. The sponsor has laid out goals in the RFP that
the project is responding to and also in the final agreement for conducting the work.</li>
<li>Dependencies between use cases. Implementation of functionality to address
some use cases will require implementation of some components not directly
specific in a use case.</li>
<li>Resources available for implementation. Some use cases may be identified as
high priority, but would require resources that would prevent implementation
of a number of other lower priority features.</li>
</ul>
</div>
<div class="section" id="use-cases">
<h1><a class="toc-backref" href="#id7">Use Cases</a></h1>
<div class="section" id="use-case-1-crud-read">
<h2><a class="toc-backref" href="#id8">Use Case 1 - CRUD Read()</a></h2>
<dl class="docutils">
<dt>Author</dt>
<dd>VDC TWG</dd>
<dt>Date</dt>
<dd><ul class="first last simple">
<li>20090924 Adding to use case description and documentation</li>
<li>20090114 (TWG meeting).  Subsequent various modifications.</li>
</ul>
</dd>
<dt>Version</dt>
<dd>Draft</dd>
<dt>Goal</dt>
<dd>Get object identified by GUID (authenticated or not, notify subscriber of access).</dd>
</dl>
<p>Summary</p>
<blockquote>
<p>A client has an identifier for some object within the DataONE system and is
retrieving the referenced object. The DataONE system must resolve the
identifier and return the object bytes after checking that the user has read
privileges on the object.</p>
<p>Watchers (subscribers) of the object are notified of the retrieval (what are
they notified of?).</p>
</blockquote>
<img alt="UseCases/images/01%20-%20Get%20object%20for%20GUID%20%28anonymous%20and%20authenticated%29.interaction.png" src="UseCases/images/01%20-%20Get%20object%20for%20GUID%20%28anonymous%20and%20authenticated%29.interaction.png" />
<dl class="docutils">
<dt>Actors</dt>
<dd><ul class="first last simple">
<li>Client requesting object</li>
<li>Coordinating Node</li>
<li>Member Node</li>
</ul>
</dd>
<dt>Preconditions</dt>
<dd><ul class="first last simple">
<li>Client has authenticated to at the desired level (e.g. client
may not have authenticated, so access might be anonymous).</li>
</ul>
</dd>
<dt>Triggers</dt>
<dd><ul class="first last simple">
<li>Watchers are notified of the retrieval</li>
<li>Operation is logged (are loggers a type of watcher?)</li>
</ul>
</dd>
<dt>Post Conditions</dt>
<dd><ul class="first last simple">
<li>The client has a copy of the object bytes (or an error message in the case
of failure)</li>
<li>The log is updated with the results of the operation</li>
<li>Watchers perform their processing</li>
</ul>
</dd>
</dl>
<div class="section" id="notes">
<h3><a class="toc-backref" href="#id9">Notes</a></h3>
<ul class="simple">
<li>for the GET operation, the coordinating node does not need to check access,
because the member node will do this check before delivering the results.</li>
<li>Data sent to watchers might include: timestamp, object identifier, user id,
IP of client,</li>
</ul>
<p>TODO: include all the individual use case text documents.</p>
</div>
</div>
</div>
<div class="section" id="dataone-application-programming-interfaces">
<h1><a class="toc-backref" href="#id10">DataONE Application Programming Interfaces</a></h1>
<p>isAuthorized (sess, transID)
read (ID, sess, transID)</p>
<div class="section" id="member-node-apis">
<h2><a class="toc-backref" href="#id11">Member Node APIs</a></h2>
<div class="section" id="authorization-api">
<h3><a class="toc-backref" href="#id12">Authorization API</a></h3>
<pre class="literal-block">
login (user, pw)
isAuth (token, GUID)
</pre>
</div>
<div class="section" id="crud-api">
<h3><a class="toc-backref" href="#id13">CRUD API</a></h3>
<pre class="literal-block">
batchGet (objectsList)
checkDataQuality (GUID)
create (token, dataPackage)
create (token, workflowObject)
get (token, handle)
getChecksum (GUID)
getLogRecords (fromDate, toDate)
log (create, creationDate, ID)
register (memberToken, ID, metadata)
</pre>
</div>
<div class="section" id="replication-api">
<h3><a class="toc-backref" href="#id14">Replication API</a></h3>
<pre class="literal-block">
cancelReplication (sess, transID)
listAllObjects ()
listRecords ()
replicationSucceeds (transID)
startReplica (ID, sessionID, transID, srcMN)
sysOp (token)
</pre>
</div>
<div class="section" id="server-authentication-api">
<h3><a class="toc-backref" href="#id15">Server Authentication API</a></h3>
</div>
<div class="section" id="capabilities-api">
<h3><a class="toc-backref" href="#id16">Capabilities API</a></h3>
<pre class="literal-block">
serviceRequest (token)
verify (token)
getCapabilities ()
State of Health API
sohQuery (token, service)
</pre>
</div>
</div>
<div class="section" id="coordinating-node-apis">
<h2><a class="toc-backref" href="#id17">Coordinating Node APIs</a></h2>
<div class="section" id="authentication-api">
<h3><a class="toc-backref" href="#id18">Authentication API</a></h3>
<pre class="literal-block">
login (user, pw)
requestToken ()
newAccount (user, pw)
</pre>
</div>
<div class="section" id="verify-api">
<h3><a class="toc-backref" href="#id19">Verify API</a></h3>
<pre class="literal-block">
isValidToken (token)
Authorization API
isAuth (token, GUID)
isAuth (token, resultset)
isValidToken (token)
setAccess (GUID, accessLevel)
takeOwnership (objectList)
</pre>
</div>
<div class="section" id="query-api">
<h3><a class="toc-backref" href="#id20">Query API</a></h3>
<pre class="literal-block">
getAllCopies (token, ownerID)
getLinksAndCites (GUID, fromDate, toDate)
getLogRecords (GUID, fromDate, toDate)
getLogRecords (nodeID, fromDate, toDate)
query (token, query)
searchForData ()
usageQuery (token, GUID)
</pre>
</div>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id21">CRUD API</a></h3>
<pre class="literal-block">
assertRelation (token, IDofSubject, relationship, IDofObject)
batchWrite (objectsList)
deleteRecords (token, listOfGUIDs)
get (token, GUID)
register (memberToken, ID, metadata)
resolve (GUID, token)
storeRecords ()
write ()
</pre>
</div>
<div class="section" id="id2">
<h3><a class="toc-backref" href="#id22">Replication API</a></h3>
<pre class="literal-block">
getDefaultReplicationPolicy (sess)
getMNReplicateList ()
getReplicationPolicy (sess, ID)
isReplicationNeeded ()
replicateMetadata ()
setDefaultReplicationPolicy (sess, policy)
setReplicationPolicy (sess, policy, ID)
</pre>
</div>
<div class="section" id="synchronization-api">
<h3><a class="toc-backref" href="#id23">Synchronization API</a></h3>
<pre class="literal-block">
pollForNewIDs ()
synchronize ()
verifyAllRecordsReceived ()
</pre>
</div>
<div class="section" id="register-api">
<h3><a class="toc-backref" href="#id24">Register API</a></h3>
<pre class="literal-block">
addNodeCapabilities ()
register (token, capabilitiesURL)
registerForNotification (token, dataOwnerID)
scheduleSynch ()
verifyCapabilities ()
</pre>
</div>
<div class="section" id="id3">
<h3><a class="toc-backref" href="#id25">Server Authentication API</a></h3>
</div>
<div class="section" id="state-of-health-api">
<h3><a class="toc-backref" href="#id26">State of Health API</a></h3>
<pre class="literal-block">
actOnPendingEvent (event)
reportPendingEvent (event)
Admin Application
notify (adminID, nodeID, service)
</pre>
</div>
</div>
</div>
</div>
</body>
</html>
